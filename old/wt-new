#!/bin/bash
# wt-new - Workspace setup script

set -e

# Copy .env* files
echo "📁 Copying environment files..."
for env_file in "$CONDUCTOR_ROOT_PATH"/.env*; do
    if [[ -f "$env_file" ]]; then
        filename=$(basename "$env_file")
        cp "$env_file" "./$filename"
        echo "  ✓ Copied $filename"
    fi
done

# Copy .claude directory
if [[ -d "$CONDUCTOR_ROOT_PATH/.claude" ]]; then
    echo "📁 Copying Claude configuration..."
    cp -r "$CONDUCTOR_ROOT_PATH/.claude" "./"
    echo "  ✓ Copied .claude/"
fi

# Install dependencies
echo "📦 Installing dependencies..."
pnpm install

# Run direnv allow if .envrc exists
if [ -f ".envrc" ] && command -v direnv >/dev/null 2>&1; then
    direnv allow
fi

echo "✅ Workspace setup complete!"